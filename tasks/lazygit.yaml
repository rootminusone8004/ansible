- name: Install LazyGit
  package:
    name: lazygit
    state: present
  register: lazygit_pkg
  failed_when: false
  changed_when: false
  
- block:
    - name: Download LazyGit binary
      get_url:
        url: https://github.com/jesseduffield/lazygit/releases/download/v0.51.1/lazygit_0.51.1_Linux_x86_64.tar.gz
        dest: /tmp/lazygit.tar.gz
  
    - name: Extract LazyGit tarball
      unarchive:
        src: /tmp/lazygit.tar.gz
        dest: /tmp
        remote_src: yes
  
    - name: Move lazygit to /usr/local/bin
      copy:
        src: /tmp/lazygit
        dest: /usr/local/bin/lazygit
        mode: '0755'
        remote_src: yes
  
    - name: Clean up LazyGit temp files
      file:
        path: "{{ item }}"
        state: absent
      loop:
        - /tmp/lazygit
        - /tmp/lazygit.tar.gz
  when: lazygit_pkg is failed
